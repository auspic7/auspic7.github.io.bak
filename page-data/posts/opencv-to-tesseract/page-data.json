{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/opencv-to-tesseract/","result":{"data":{"markdownRemark":{"id":"4a7f3b61-a669-5027-879c-2cf611053d13","html":"<p>팀 프로젝트를 진행하다가 Input이 이미지나 Pix가 아닌 Mat으로 주어져야 하는 상황에 직면했다. TessBaseAPI는 Mat를 절대로 알아먹을 수 없기에 중간에 형변환하는 것은 피할 수 없는 선택이었고, 여러 가지 포럼을 찾아본 끝에 해답을 찾아냈다. StackOverflow에 나온 컨버팅 방법은 왜인지 GetUTF8Text에서 오류를 뿜어냈고(Pix로 변환하는 과정에서 몇 가지의 속성이 초기화되지 않은 것으로 보인다), 해답은 직접 TessBaseAPI에 SetImage를 해 주는 것이었다. 다음은 그 소스코드이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c++\"><pre class=\"language-c++\"><code class=\"language-c++\">//\n\n//  main.cpp\n\n//  tesseractOCR\n\n//\n\n//  Created by Myeongwon on 2015. 10. 21..\n\n//  Copyright © 2015년 Myeongwon. All rights reserved.\n\n//\n\n\n\n\n\n\n\n#include &lt;tesseract/baseapi.h&gt;\n\n#include &lt;leptonica/allheaders.h&gt;\n\n#include &lt;opencv2/core/core.hpp&gt; \n\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n\n#include &lt;opencv2/imgproc/imgproc.hpp&gt;\n\n#include &lt;iostream&gt;\n\n\n\nusing namespace cv;\n\nusing namespace std;\n\nint _mat();\n\nPix *pixtes;\n\ntesseract::TessBaseAPI api;\n\n\n\nint main()\n\n{\n\n    char *outText;\n\n    \n\n    _mat();\n\n    \n\n    outText = api.GetUTF8Text();\n\n    printf(&quot;OCR output:\\n%s&quot;undefined outText);\n\n    namedWindow( &quot;Display window&quot;undefined WINDOW_AUTOSIZE );\n\n\n\n    // 메모리 릴리즈\n\n    api.End();\n\n    delete [] outText;\n\n    \n\n    pixDestroy(&amp;pixtes);\n\n    \n\n    return 0;\n\n}\n\n\n\nint _mat(){\n\n        \n\n    Mat image = imread(&quot;%__imagepath__&quot;undefined CV_LOAD_IMAGE_COLOR);   // 파일을 MAT에 입력\n\n\n\n    printf(&quot;%d&quot;undefined  image.depth() == CV_8U);\n\n    namedWindow( &quot;Display window&quot;undefined WINDOW_AUTOSIZE );\n\n    imshow( &quot;Display window&quot;undefined image );\n\n    // 이미지 로딩\n\n    \n\n    cv::Mat gray;\n\n    cv::cvtColor(imageundefined grayundefined CV_BGR2GRAY);\n\n    // 개략적인 전처리\n\n    \n\n    // Tesseract API로 입력시킴. Pix자료형으로 바꿀 수 있을...까?\n\n    api.Init(NULLundefined &quot;eng&quot;undefined tesseract::OEM_DEFAULT);\n\n    api.SetPageSegMode(tesseract::PSM_SINGLE_BLOCK);\n\n    api.SetImage((uchar*)gray.dataundefined gray.colsundefined gray.rowsundefined 1undefined gray.cols);\n\n    api.Recognize(0);\n\n    waitKey(0);                \n\n    \n\n    return 0;\n\n\n\n}</code></pre></div>","fields":{"slug":"/posts/opencv-to-tesseract/","tagSlugs":["/tag/programming/","/tag/c/","/tag/open-cv/","/tag/cycle/"]},"frontmatter":{"date":"20151021T010000+0900","description":"팀 프로젝트를 진행하다가 Input이 이미지나 Pix가 아닌 Mat으로 주어져야 하는 상황에 직면했다. ","tags":["Programming","C++","OpenCV","cycle"],"title":"OpenCV에서 프로세싱한 이미지 Tesseract에서 사용하기","socialImage":"/media/image-2.jpg"}}},"pageContext":{"slug":"/posts/opencv-to-tesseract/"}}}